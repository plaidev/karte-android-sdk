apply plugin: "jacoco"

jacoco {
    // 0.8.11+ required for Java 21 support (class file major version 65)
    toolVersion = "0.8.12"
}

task jacocoMerge(
        type: JacocoReport,
        group: "verification",
        dependsOn: [
                "core:jacocoTestReport",
                "inappmessaging:jacocoTestReport",
                "notifications:jacocoTestReport",
                "variables:jacocoTestReport",
                "visualtracking:jacocoTestReport",
                "inbox:jacocoTestReport",
                "debugger:jacocoTestReport",
                "inappframe:jacocoTestReport"
        ]
) {
    gradle.afterProject { project, _ ->
        if (project.rootProject != project && project.plugins.hasPlugin('jacoco')) {
            executionData "${project.buildDir}/jacoco/testDebugUnitTest.exec"
        }
    }
}
